const Nenge=new class{version=1;DB_NAME="XBBS";DB_STORE_MAP={libjs:{},myfile:{timestamp:!1}};constructor(){const e=this,t=e.I;self.Nenge=e,e.language=t.language,e.i18nName=t.i18n,e.on(window,"error",(e=>{t.mobile&&alert(e.message)})),e.triger(document,"NengeStart",{detail:e}),e.docload((t=>e.triger(document,"NengeReady",{detail:e})))}LibStore="libjs";maxsize=104857600;part="-part-";lang={};action={};StoreTable={};JSpath=document.currentScript&&document.currentScript.src.split("/").slice(0,-1).join("/")+"/";get date(){return new Date}get time(){return this.date.getTime()}get rand(){return Math.random()}get randNum(){return this.I.Int(this.rand.toString().slice(2))}async getItem(e,t,s,r={}){if(!t)return await this.getAllData(e,1,r);let n=this,a=n.F,i=n.I,o=await a.dbGetItem(i.assign({store:e,name:t},r));if(i.obj(o)){let l=n.maxsize,c=n.part,d=t.split(c)[0],u=o.version,p=o.filesize/l,h=o.type;s&&u&&u!=s?o=void 0:p>1&&(o.contents=i.R(14,await i.Async(i.toArr(p).map((async s=>{let n=d;if(s>0&&(n+=c+s),n==t)return o.contents;{let t=await a.dbGetItem(i.assign(r,{store:e,name:n}));return t&&t.contents||i.U8(0)}}))),o.filename||d,{type:o.filetype||a.getMime(o.filename||d)}));let m=o.contents;!m||i.str(m)||i.obj(m)||("unpack"==h?m=await a.unFile(m,{password:r.password||o.password,process:r.process}):["String","Json"].includes(h)?(m=i.blob(m)?await m.text():i.decode(m),("Json"==h||/json/.test(o.filetype))&&(m=i.Json(m))):"File"!=h&&i.blob(m)&&(m=i.U8(await m.arrayBuffer())),o.contents=m)}return o}async setItem(e,t,s,r){let n=this,a=n.F,i=n.I,o=n.maxsize,l=n.part;if(i.obj(s)&&s.contents){let c=s.contents;if(c=await a.dbU8(c,o),i.u8buf(c)&&c.byteLength>o){let d=c.byteLength;return s.filesize=d,s.contents=null,delete s.contents,s=i.toObj(i.toArr(s).filter((e=>!i.none(e[1])))),await i.Async(i.toArr(d/o).map((e=>(e*=o,i.U8(c.subarray(e,d-e>=o?e+o:d))))).map((async(n,o)=>a.dbPutItem({store:e,data:i.assign({contents:n},s),name:o>0?t+l+o:t,dbName:r}))))&&(t=null,d=null,o=null,c=null,n.null(s))}s.contents=c}else if(s&&(s=await a.dbU8(s,o),i.u8buf(s)&&s.byteLength>o))return n.setItem(e,t,{contents:s,timestamp:n.date},r);return await a.dbPutItem({store:e,data:s,name:t,dbName:r})}async removeItem(e,t,s){let{clear:r,dbName:n,size:a}=s||{},i=this,o=i.I,l=i.F;if(r){if(!a){let r=await l.dbGetItem(o.assign({store:e,name:t},s));a=r&&r.filesize,i.null(r)}if(a){let s=t.split(i.part)[0];return await o.Async(o.toArr(a/i.maxsize).map((async t=>{let r=s;return t>0&&(r+=i.part+t),await l.dbRemoveItem({store:e,name:r})+"\n"})))}}return await l.dbRemoveItem({store:e,name:t,dbName:n})}async getAllData(e,t,s){if(!e)return{};return await this.F.dbGetAll(this.I.assign({store:e,only:t},s))}async getContent(e,t,s,r){let n=await this.getItem(e,t,s,r);return n&&n.contents||n}async setContent(e,t,s,r,n){let a=this;return await a.setItem(e,t,a.I.assign({contents:s,timestamp:a.date},r),n)}async getAllKeys(e,t,s){return await this.F.dbGetKeys(this.I.assign({store:e,dbName:t},s||{}))}async getAllCursor(e,t,s,r){return await this.F.dbGetCursor(this.I.assign({store:e,index:t,only:s},r))}async clearDB(e,t){let s=this.F;if(e)return s.I.str(e)&&(e=[e]),await s.dbRemoveTable(e,t)}async deleteDB(e,t){let s=this.F;return s.I.str(e)&&(e=[e]),await s.deleteDatabase(e,t)}getStore(e,t){if(!e)return;let s=this;return e instanceof s.StoreBase?e:(t=t||s.DB_NAME,s.StoreTable[t]||(s.StoreTable[t]={}),s.StoreTable[t][e]||(s.StoreTable[t][e]=new s.StoreBase(e,t)),s.StoreTable[t][e])}async FetchItem(e){let t=this,s=t.F,r=t.I;e&&!r.str(e)||(e={url:e||"/"});let n,a,i,o="arrayBuffer",l=s.getname(e.url),c=e.key||l||"index.php",d=c==s.LibKey?c+l:c,u=e.version,p={},h=e.decode,m=h&&(r.str(h)?e=>r.decode(e,h):!0===h?r.decode:h),b=e.store&&t.getStore(e.store),g=(t,n)=>s.unFile(t,r.assign(e,{password:n})),y=async s=>(s&&s.contents&&("unpack"==s.type?(s=await g(s.contents,s.password)).password&&delete s.password:s=s.contents),f(s),t.null(e),e=null,s),f=t=>t&&e.success&&e.success(t,p);if(delete e.store,e.filename||(e.filename=l),e.onLine&&(e.unset=navigator.onLine),b&&(n=await b.get(d,u,e),n&&!e.unset&&!e.checksize))return y(n);if(a=await s.FetchStart(e).catch((t=>e.error&&e.error(t.message))),!a)return y(n);p=s.FetchHeader(a,e),r.exends(p,a,["url","status","statusText"]),e.filename&&(p.filename=e.filename);let w=p.password||e.password||void 0;if(200!=a.status)return a.body&&(a.body.cancel(),e.error&&e.error(a.statusText,p)),"head"==e.type&&f(p),y(n);if(n&&n.filesize&&p.byteLength>0){if(n.filesize==p.byteLength)return a.body.cancel(),y(n);t.null(n),n=null}else if("head"==e.type)return a.body.cancel(),y(p);let v=r.func(e.process)?await s.StreamResponse(a,e.process,p):a;e.unpack&&(e.type=o),e.type=e.type||o,i=await v[e.type]();let I=p.type,j=p.byteLength||0,A=p["content-type"];if(e.type==o&&r.buf(i)&&(i=r.U8(i),e.Filter&&(i=await e.Filter(i)),I=r.N(11),j=i.byteLength,e.autounpack&&j<.3*t.maxsize&&(e.unpack=!0)),e.dataOption=e.dataOption||{},b&&e.unpack&&c===d&&j>t.maxsize&&(I="unpack",await b.put(d,r.assign({contents:i,timestamp:new Date,filesize:j,filetype:A,version:u,type:I,password:w},e.dataOption)),b=null),e.unpack&&r.u8buf(i)&&(i=await g(i,w),i.byteLength||(i.password&&(w=i.password,delete i.password),I="datalist")),b&&c!==d){if(r.u8buf(i))i=s.getFileText(i,m,e.mime||p["content-type"]||s.getMime(""),l),I=r.blob(i)?"File":"String";else if(r.str(i))I=p["content-type"]||"String";else if("datalist"==I){let n;await r.Async(r.toArr(i).map((async a=>{let[i,o]=a,l=s.getname(i),d=s.getMime(l),u=s.getFileText(o,m,d,l);return await b.put(c+l,r.assign({contents:u,timestamp:t.date,filesize:o.byteLength,filetype:d,version:t.version,type:r.blob(u)?"File":"String"},e.dataOption)),e.filename==l&&(n=u),!0}))),n&&(i=n),n=null,b=null}}else m&&(i=s.getFileText(i,m,I),r.str(i)&&(I="String"));return b&&await b.put(d,r.assign({contents:i,timestamp:t.date,filesize:j,filetype:A,version:u,type:I,password:w},e.dataOption)),y(i)}ajax(e){let t=this,s=t.I;return s.str(e)&&(e={url:e}),s.Async((r=>{const n=new XMLHttpRequest(e.paramsDictionary);let a=["progress","readystatechange","error","abort","load","loadend","loadstart","timeout"],{DONE:i,HEADERS_RECEIVED:o,LOADING:l,OPENED:c,UNSENT:d}=n;t.on(n,a[2],(t=>{e.error&&e.error("net::ERR_FAILED"),r(null)})),t.on(n,a[1],(t=>{let a;switch(n.readyState){case l:case c:case d:break;case o:if(a=s.toObj((n.getAllResponseHeaders()||"").trim().split(/[\r\n]+/).map((e=>{let t=e.split(": ");return[t.shift(),t.join(": ")]})).concat([["status",n.status],["statusText",n.statusText],["url",e.url]])),"head"==e.type)return n.abort(),e.success&&e.success(a,n),void r(a);break;case i:200==n.status?(e.success&&e.success(n.response,a,n),r(n.response)):(e.error&&e.error(n.statusText,a,n),r(null));break}})),e.process&&t.on(n,a[0],(t=>e.process(s.PER(t.loaded,t.total),t.total,t.loaded,0,n))),e.postProcess&&t.on(n.upload,a[0],(t=>e.postProcess(s.PER(t.loaded,t.total),t.total,t.loaded,t))),s.toArr(a,(r=>s.none(e[r])||(t.on(n,val,e[r]),s.DP(e,r)))),e.upload&&s.toArr(a,(r=>s.none(e.upload[r])||(t.on(n,val,e.upload[r]),s.DP(e.upload,r))));let u,p=e.type||"",h=e.headers||{};e.overType&&n.overrideMimeType(e.overType),e.json?(u=s.toJson(e.json),p||(p="json"),s.assign(h,{Accept:"application/json, text/plain, */*"})):e.post&&(u=s.post(e.post)),"head"!=p&&(n.responseType=p),n.open(u?"POST":"GET",s.get(e.url,{inajax:t.time},e.get)),s.toArr(h,(e=>n.setRequestHeader(e[0],e[1]))),n.send(u)}))}Set(e,t){let s=this,r=s.I,{RF:n,CF:a,BF:i}=s;return e.action||(e.action={}),r.defines(e,{T:s,I:r},1,t),r.defines(e,{RF:n,CF:a,BF:i},1),r}RF(e,t){const s=this,r=s.action,n=s.I;if(r[e])return n.func(r[e])?n.Apply(r[e],s,t||[]):r[e]}CF(e,...t){return this.RF(e,t)}BF(e){const t=this,s=t.action,r=t.I;if(s[e])return r.func(s[e])?s[e].bind(t):s[e]}addJS(e,t,s,r){let n=this,a=n.F,i=n.I;if(i.blob(e)&&(r=a.getKeyName(e.name),"text/css"==e.type&&(s=!0)),r&&n.$("#link_"+r))return;let o=!1,l=n.$ce(s?"link":"script"),c=t=>{/^(blob:)?https?:\/\//.test(e)||/(\.js$|\.css$)/.test(e)||(o=!0,e=a.URL(e,a.getMime(s?"css":"js"))),s?(l.type=a.getMime("css"),l.href=e,l.rel="stylesheet"):(l.type=a.getMime("js"),l.src=e),r&&i.Attr(l,{id:"link_"+r}),l.onload=r=>{t&&t(r),o&&a.removeURL(e),e=null,s||l.remove()},document[s?"head":"body"].appendChild(l)};return t?(c(t),l):i.Async(c)}async loadScript(e,t,s){t=t||{};let r=this,n=r.F;t.url=n.getpath(e),s?t.type="text":(t.store||(t.store=r.LibStore),t.key||(t.key=n.LibKey)),t.version=t.version||r.version;let a=await r.FetchItem(t);return s?a:await r.addJS(a)}async getScript(e,t){return this.loadScript(e,t,!0)}async addScript(e,t){return await T.addJS(await T.getScript(e,t),null,"css"==F.getExt(e))}async loadLibjs(e,t,s,r){let n=this.F;return await this.addJS(await n.getLibjs(e,t,s,r),null,"css"==n.getExt(e))}unFile(e,t,s){return this.F.unFile(e,this.I.assign({process:t},s||{}))}async toZip(e,t,s){let r=this,n=r.I;return n.Async((async a=>{let i=new Worker(r.JSpath+"zip.js?"+r.time);r.on(i,"message",(e=>{let s=e.data;1==s.t?(a(s.contents),e.target.terminate()):2==s.t&&t&&t(n.PER(s.current,s.total))})),r.on(i,"error",(e=>{a(null),i.terminate()})),i.postMessage(n.assign({contents:e},s||{})),e=null}))}on(e,t,s,r,n){let a=this,i=a.I;return e=a.$(e),a.spilt(t,(t=>i.on(e,t,s,!1===r?{passive:!1}:r,n))),e}un(e,t,s,r,n){let a=this,i=a.I;return e=a.$(e),a.spilt(t,(t=>i.un(e,t,s,!1===r?{passive:!1}:r,n))),e}spilt(e,t,s){let r=this.I,n=s||",";return r.toArr(r.str(e)?e.replace(/[\s\|,]+/g,n).split(n).filter((e=>!r.empty(e))):e,t)}once(e,t,s,r){return this.on(e,t,s,{passive:!1,once:!0},r)}docload(e){let t=this,s=document;return"complete"==s.readyState?e&&e.call(t):t.I.Async((r=>{let n=()=>{e&&e.call(t),r(t)};"loading"==s.readyState?t.once(s,"DOMContentLoaded",n):n()}))}$(e,t){let s=this.I;return e?s.str(e)?s.$(e,t):s.func(e)?this.docload(e):e:void 0}$$(e,t){return this.I.$$(e,t)}$ce(e){return this.I.$c(e)}$ct(e,t,s,r){let n=this.I,a=this.$ce(e);return t&&(a.innerHTML=n.str(t)?t:t()),!r||n.Attr(a,r),!s||n.Attr(a,"class",s),a}$append(e,t){return this.I.str(t)&&(t=this.$ce(t)),e.appendChild(t),t}$add(e,t){return e.classList.add(t),e}customElement(e){let t=this;window.customElements.define(e,class extends HTMLElement{constructor(){super(),t.CF("TAG-"+this.tagName,this,"init")}connectedCallback(){t.CF("TAG-"+this.tagName,this,"connect")}attributeChangedCallback(e,s,r){t.CF("TAG-"+this.tagName,this,"attribute",{name:e,oldValue:s,newValue:r})}disconnectedCallback(){t.CF("TAG-"+this.tagName,this,"disconnect")}})}docElm(e,t){return(new DOMParser).parseFromString(e,t||"text/html")}HTMLToTxt(e,t){let s=this.I;return s.str(e)&&(e=this.docElm(e)),s.doc(e)?e.body[t?"innerHTML":"textContent"]:""}fragment(){return new DocumentFragment}Err(e){return new Error(e)}down(e,t,s){return this.F.download(e,t,s)}getLang(e,t){let s=this,r=s.I;return r.none(s.lang[e])||(e=s.lang[e]),r.obj(t)?r.RegRe(e,t):e}triger(e,t,s){let r=this,n=r.I;return e=r.$(e),n.evt(t)?r.dispatch(e,t):r.dispatch(e,new n.O[22](t,s)),e}dispatch(e,t){return e.dispatchEvent(t),e}stopGesture(e){this.on(e,"gesturestart,gesturechange,gestureend",this.stopEvent)}stopEvent(e){e.preventDefault()}stopProp(e,t){t||e.preventDefault(),e.stopPropagation()}null(e){for(var t in e)e[t]=null,delete e[t]}I=new class{O=[Array,Object,Element,HTMLFormElement,FormData,URLSearchParams,NamedNodeMap,DOMStringMap,CSSStyleDeclaration,Document,ArrayBuffer,Uint8Array,Promise,Blob,File,String,DOMRect,Event,KeyboardEvent,Function,Boolean,Headers,CustomEvent,HTMLCollection,FileList,TextDecoder,TextEncoder,NodeList,Number,RegExp];constructor(e){let t=this,s=t.O,r="",n="return ",a=n+"o",i="this.",o=n+i,l=o+"toArr(",c=e=>n+t.N(e)+".",d=e=>o+"Apply("+(e?"add":"remove")+"EventListener,o,a)",u=e=>"new "+t.N(e),p=e=>n+u(e)+"(o)",h=(e,s)=>m(e,o+"C(o) === "+t.N(s)),m=(e,t)=>t?`'${e}':{value(o,...a){${t}}},`:"",b=(e,s,r)=>s?m(t.N(e)+(r?"2obj":"2arr"),s):"",g=e=>o+t.N(e)+"2obj(o)",y=e=>o+t.N(e)+"2arr(o)",f=e=>o+"Entries("+i+t.N(e)+"2obj(o))",w=e=>o+"FromEntries("+i+t.N(e)+"2arr(o))",v=e=>`return this.ArrFrom(${e})`,I="document",j=n+"(a[0]||"+I+").querySelector",A=v("o");s[1].entries({2:"elm",3:"elmform",4:"urlpost",5:"urlget",6:"nodemap",7:"DOMmap",8:"elmCss",12:"await",13:"blob",14:"file",17:"evt",18:"keyevt",19:"func",21:"header",27:"nodelist"}).forEach((e=>{return r+=(s=e[1],a=e[0],m(s,n+"o instanceof "+t.N(a)));var s,a})),s[1].entries({0:"array",1:"obj",9:"doc",10:"buf",11:["u8obj","u8buf"],15:"str",20:"bool",28:"num"}).forEach((e=>r+=e[1]instanceof s[0]?e[1].map((t=>h(t,e[0]))).join(""):h(e[1],e[0]))),s[1].entries({null:a+"===null",none:n+'typeof o == "undefined"',R:n+"Reflect.construct(this.O[o],a)",H:n+"a[0]&&o.hasOwnProperty(a[0])||false",DP:n+"Reflect.deleteProperty(o,a[0])",Arr:p(0),ArrFrom:c(0)+"from(o)",FromEntries:c(1)+"fromEntries(o)",Keys:c(1)+"keys(o);",FromObj:c(1)+"fromEntries(o);",U8:o+"u8buf(o)?o:"+u(11)+"(o.buffer||o)",buf16str:l+'o).map(v => v.toString(16).padStart(2,0).toLocaleUpperCase()).join("")',ArrTest:l+"o).filter(entry => entry[1].test(a[0]))[0]",decode:n+u(25)+"(a[0]).decode(o)",encode:n+u(26)+"().encode(o)",FormPost:p(4),FormGet:p(5),Int:p(28),IntVal:n+"parseInt(o,a[0])",IntSize:"o=this.Int(o);",PER:o+'Int(100*o/a[0]).toFixed(0)+"%"',Async:a+"?(this.array(o) ? "+t.N(12)+".all(o):new "+t.N(12)+"(o,a[0])):null;",$:j+"(o)",$$:j+"All(o)",$c:n+I+".createElement(o)",RegRe:l+"a[0],e=>o=o.replace("+u(29)+'("\\{"+e[0]+"\\}","g"),e[1])),o',elmdata:o+"toObj(o&&o.dataset||{})||{}",setStyle:o+"toArr(a[0],x=>(o.style||o).setProperty(x[0],x[1])),o",Attr:o+'obj(a[0])?this.toArr(a[0],v=>this.Attr(o,v[0],v[1])):o[(a[1]?"set":"get")+"Attribute"](a[0],a[1])',Call:n+"Reflect.apply(o,a.shift(),a)",Apply:o+"str(o)&&(o=a[0][o]),Reflect.apply(o,a[0],a[1])",on:d(1),un:d(0)}).forEach((e=>r+=m(e[0],e[1]))),s[1].entries({4:["var s = {};o.forEach((t, e) => {s[e] ? (this.array(s[e]) || (s[e] = [s[e]]), s[e].push(t)) : s[e] = t});return s",f(4)],5:[g(4),y(4)],6:[w(6),A+".map(v=>[v.name,v.value])"],7:[c(1)+"assign({}, o)",f(7)],8:[w(8),A+".map(v=>[v,o.getPropertyValue(v)])"],10:[a,v(i+"U8(o)")],11:[a,A],16:[n+"o.toJSON()",f(16)],21:[g(4),y(4)],23:[a,A],24:[a,A],27:[a,A],28:[a,o+"Arr(Math.ceil(o)).fill().map((...x)=>x[1])"]}).forEach((e=>r+=b(e[0],e[1][0],1)+b(e[0],e[1][1])));var L=new s[19]("I","T",t.N(1)+`.defineProperties(I,{${r}});T.StoreBase=class Store{constructor(table,name){const S=this;Nenge.Set(S);S.I.defines(S,{table,name},1,1);S.getdata=S.getData;S.setdata=S.setData;}setName(t){let e=${i}I;${n}t&&"boolean"!=typeof t?e.str(t)&&(t={dbName:t}):t={dbName:e.name},t}get(t,e,a){${o}getItem(t,e,${i}setName(a))}put(t,e){${o}setItem(t,e,${i}name)}remove(t,e){${o}removeItem(t,${i}setName(e))}data(t,e,a){${o}getData(t,e,a)}getData(t,e,a){${o}getContent(t,e,${i}setName(a))}setData(t,e,a){${o}setContent(t,e,a,${i}name)}keys(t){${o}getAllKeys(${i}name,t||{})}cursor(t,e,a){${o}getAllCursor(t,e,${i}setName(a))}all(t,e){${o}getAllData(t,${i}setName(e))}clear(){${o}clearDB(${i}name)}delete(){${o}deleteDB(${i}name)}async getBatch(t,e){let a=await ${i}I.Async(t.map((async t=>await ${i}get(t))));${n}e?e(a):a}${"getItem,setItem,removeItem,getAllData,getContent,setContent,getAllKeys,getAllCursor,clearDB,deleteDB".split(",").map((e=>{return t=e,(s=`const S=this;${n}S.I.Apply('${e}',S.T,[S.table].concat(a))`)?`${t}(...a){${s}}`:"";var t,s})).join("")}}`);L(t,e),r=null,L=null}N(e){return isNaN(e)?this.X(e):this.O[e].name}C(e){return null!=e&&null!=e&&e.constructor}X(e){return this.C(e)&&this.C(e).name||""}assign(...e){return this.Apply(this.O[1].assign,{},e)}exends(e,t,s){return s?this.toArr(s,(s=>e[s]=t[s])):e=this.assign(e,t),e}get mobile(){return"ontouchend"in document}get language(){return navigator.language}get i18n(){let e=this.language.split("-");return e="zh"==e[0]?"CN"==e[1]?"zh-hans":"zh-hant":e[0],e}post(e){let t=this,s=t.urlpost(e)?e:t.FormPost(t.elmform(e)?e:t.str(e)?t.$(e):void 0);return t.obj(e)&&t.toArr(e,(e=>s.append(e[0],e[1]))),s}get(e,...t){let s=this,r=e.split("?"),n=r[1]&&r[1].split("#")[0]||"",a=s.toArr(t).map((e=>e?s.FormGet(e):"")).join("&"),i=s.FormGet(n+"&"+a).toString().replace(/=&/g,"&");return r[0]+(i?"?"+i:"")}toObj(e){if(!e)return{};let t=this,s=t.X(e);return t[s+"2obj"]?t[s+"2obj"](e):t.obj(e)?e:t.array(e)?t.FromObj(e):e}Entries(e){return this.O[1].entries(e)}toArr(e,t){if(!e)return[];let s=[],r=this,n=r.X(e);return r[n+"2arr"]?s=r[n+"2arr"](e):r.array(e)?s=e:e.byteLength||e.length?s=r.ArrFrom(e):r.obj(e)&&(s=r.Entries(e)),r.func(t)?s.forEach(t):s}define(e,t,s,r,n){return this.O[1].defineProperty(e,t,r?{get:()=>s,configurable:!!n}:s),e}defines(e,t,s,r){return s?this.toArr(t,(t=>this.define(e,t[0],t[1],1,r))):this.O[1].defineProperties(e,t),e}Json(e){let t=this,s=t.O;return t.u8buf(e)&&(e=t.decode(e)),"string"==typeof e?new s[19]("return "+e)():e}toJson(e){return JSON.stringify(this.Json(e))}empty(e){return!e||(this.str(e)?0==e.trim().length:this.array(e)?0==e.length:!!this.obj(e)&&0==this.toArr(e).length)}}(this);F=new class{Libjs={};LibKey="script-";zipsrc="zip.min.js";extpreg={"7z":/^377ABCAF271C/,rar:/^52617221/,zip:/^504B0304/,png:/^89504E470D0A1A0A/,gif:/^47494638/,jpg:/^FFD8FF/,webp:/^52494646/,pdf:/^255044462D312E/};exttype={"text/javascript":["js"],"text/css":["css","style"],"text/html":["html","htm","php"],"text/plain":["txt"],"text/xml":["xml","vml"],image:["jpg","jpeg","png","gif","webp"],"image/svg+xml":["svg"],application:["pdf"],"application/json":["json"],"application/x-zip-compressed":["zip"],"application/x-rar-compressed":["rar"],"application/x-7z-compressed":["7z"]};action={textext(e){let t=this.I,s=t.buf16str(e),r=t.ArrTest(this.extpreg,s);return r&&r[0]?r[0]:""},async rar(e,t,s){let r,n=this,a=n.I;a.blob(e)&&(!t.filename&&e.name&&(t.filename=e.name),e=a.U8(await e.arrayBuffer())),s=s||"libunrar.min.zip",n.Libjs[s]||await n.getLibjs(s,r);let i,o=n.Libjs[s];return t.process&&(i=t.filename?n.T.getLang("Decompress:")+t.filename+" --":n.T.getLang("Decompress:"),r=e=>t.process(i+(e.file?n.getname(e.file):"")+" "+a.PER(e.current,e.total),e.total,e.current)),a.Async((s=>{let a,i=new Worker(o);i.onmessage=o=>{let l=o.data,c=l.t;if(1===c)s(a||e),o.target.terminate();else if(2===c)a||(a={}),a[l.file]=l.data;else if(4===c&&l.total>0&&l.total>=l.current)r&&r(l);else if(-1==c){let r=prompt(n.T.getLang(l.message),t.password||"");if(!r)return s(e),o.target.terminate();t.unpack&&(a.password=r),t.password=r,i.postMessage({password:r})}},i.onerror=async t=>{s(e),i.terminate()},i.postMessage({contents:e,password:t.password})}))},"7z":function(e,t){return this.CF("rar",e,t,"extract7z.zip")},async zip(e,t={}){return this.T.Libzip==this.zipsrc?this.CF("zipjs",e,t):this.CF("rar",e,t,this.T.Libzip)},async zipjs(e,t){t=t||{};let s=this.T;window.zip||await s.loadLibjs(s.JSpath+this.zipsrc);var r=new zip.ZipReader(new(zip[s.I.u8buf(e)?"Uint8ArrayReader":"BlobReader"])(e)),n={},a=void 0,i=async e=>{n[e.filename]=await e.getData(new zip.Uint8ArrayWriter,{onprogress:(r,n)=>t.process&&t.process(e.filename+" "+s.I.PER(r,n)),password:a})},o=async e=>{try{null==a&&(a=t.password),await i(e)}catch(t){a=window.prompt(s.getLang("Invalid password"),a),await o(e)}},l=await r.getEntries(),c=0;if(l)for(;l[c];){let e=l[c];c++,e.directory||(e.encrypted&&!a?await o(e):await i(e))}return n}};async StreamResponse(e,t,s){let r=this.I,n=s["content-length"]||0,a=this.T.getLang("process:"),i=0,o={done:!1,value:!1},l=await e.body.getReader();return new Response(new ReadableStream({async start(e){for(;!o.done;){let c=0,d="";o.value&&(c=o.value.length,i+=c,e.enqueue(o.value)),d=n&&i<n?a+r.PER(i,n):a+(i/1024).toFixed(1)+"KB",t((s.filename?s.filename+" ":"")+d,n,i,c),o=await l.read()}e.close()}}))}FetchHeader(e,t){let s=this.I,r=s.toObj(e.headers)||{};return(r["content-type"]||this.getMime(t.url.split("/").pop()||"html")).split(";").forEach(((e,t)=>{if(e=e.trim().toLowerCase(),0==t)r["content-type"]=e;else if(-1!=e.search(/=/)){let t=e.split("=");r[t[0].trim()]=t[1].trim()}})),s.assign(r,{byteLength:s.Int(r["content-length"])||0,password:r.password||r["content-password"],type:r.type||r["content-type"].split("/")[1].split("+")[0]})}async FetchStart(e){let t=this.I,{url:s,get:r,post:n,json:a}=e||{},i={headers:{method:"GET"}};return t.toArr(["headers","context","referrer","referrerPolicy","mode","credentials","redirect","integrity","cache"],(s=>t.none(e[s])||(i[s]=e[s],t.DP(e,s)))),a?(n=t.toJson(a),i.headers=t.assign({Accept:"application/json"},i.headers)):n&&(n=t.post(n)),n&&(i.method="POST",i.body=n),t.toArr(["get","post","json"],(s=>t.DP(e,s))),fetch(t.get(s,r),i)}CheckExt(e){let t=this.I,s=e.slice(0,16),r=this.BF("textext"),n=t.blob(s)?s.arrayBuffer():t.str(s)?t.encode(s):s;return t.await(n)?t.Async((async e=>e(r(await n)))):r(n)}async unFile(e,t={}){let s=this,r=s.I;r.await(e)&&(e=await e),r.array(e)&&(e=r.U8(e));let n=await s.CheckExt(e);return!s.action[n]||t.PassExt&&t.PassExt.includes(zip)?(r.blob(e)&&(e=r.U8(await e.arrayBuffer())),e):await s.CF(n,e,t)}async getLibjs(e,t,s,r){let n=this,a=n.T,i=n.I,o=n.getname(e),l=o.replace(/\.zip$/,".js");if(n.Libjs[o])return n.Libjs[o];if(n.Libjs[l])return n.Libjs[l];s=s||a.version;let c=await a.getStore(a.LibStore).data(n.LibKey+l,s);return c||(/\.zip$/.test(o)&&await n.getLibjs(a.Libzip,t),c=await a.FetchItem({url:n.getpath(e)+"?"+a.time,store:a.LibStore,key:n.LibKey,unpack:!0,filename:l,version:s,process:t,decode:r})),/json$/.test(l)?n.Libjs[l]=c:c&&(i.obj(c)?n.I.toArr(c,(e=>n.Libjs[e[0]]=e[1]&&n.URL(e[1],n.getMime(e[0])))):n.Libjs[l]=n.URL(c,n.getMime(l))),c=null,n.Libjs[l]}getname(e){return(e||"").split("/").pop().split("?")[0].split("#")[0]}getpath(e){let t=this.T;t.I;return/^(\/|https?:\/\/|static\/js\/|data\/|assets|blob\:)/.test(e)?e:t.JSpath+e}getFileText(e,t,s,r){let n=this,a=n.T.I;return/json$/.test(s)&&a.u8buf(e)?a.Json(e):r&&s&&!t?a.R(14,[e],r,{type:s}):t?a.u8buf(e)?t(e):(a.toArr(e,(s=>{/(text|javascript|xml)/.test(n.getMime(s[0]))&&(e[s[0]]=t(s[1]))})),e):e}getExt(e){return this.getname(e).split(".").pop().toLowerCase()}getKeyName(e){let t=this.getname(e).split(".");return t.pop(),t.join(".")}getMime(e){let t,s=this;return(e=s.getExt(e))&&s.I.toArr(s.exttype,(s=>s[1].includes(e)&&(t=s[0]))),"image"==t&&(t+="/"+e),t||"application/octet-stream"}URL(e,t){let s=this.I;return s.str(e)&&(/^(blob|http)/.test(e)||/^\/?[\w\-_\u4e00-\u9FA5:\/\.\?\^\+ =%&@#~]+$/.test(e))?e:(t||(t=this.getMime("js")),window.URL.createObjectURL(s.blob(e)?e:new Blob([e],{type:t})))}removeURL(e){return window.URL.revokeObjectURL(e)}download(e,t,s){let r,n=this,a=n.I;s=s||n.getMime(e),a.str(e)?/^(http|blob:)/.test(e)?(r=e,e="n.js"):t&&(r=n.URL(t,s)):(r=n.URL(e,s),e=e.name||"n.js");let i=document.createElement("a");i.href=r,i.download=e,i.click(),i.remove()}DataBase={};get idb(){return window.indexedDB||window.webkitindexedDB}dbSetMap(e){let t=this,s=t.I,r=t.T,n=t.dbMap||{};n&&!n[t.dbname]&&(n[t.dbname]=r.DB_STORE_MAP);let a=e.store;if(a){let r=e.dbName||t.dbname;if(r&&!n[r]&&(n[r]={}),a&&!n[r][a]){n[r][a]={};let t=e.dbIndex;t&&(s.str(t)?n[r][a][t]=!1:s.assign(n[r][a],t))}}return t.dbMap||(t.dbMap=n),n}async dbLoad(e){let t=this,s=(e=e||{}).dbName||t.dbname,r=e.store,n=t.DataBase[s];return r&&t.dbCheckTable(r,n)||!r&&n?n:(e.dbName=s,await t.dbInstall(t.dbSetMap(e)),t.DataBase[s])}async dbInstall(e){let t=this,s=t.I;return await s.Async(s.toArr(e).map((async e=>{let r,[n,a]=e,i=t.DataBase[n];if(i){if(!s.toArr(a).filter((e=>!t.dbCheckTable(e[0],i))).length)return"ok";r=i.version+1,i.close(),delete t.DataBase[n]}let o=s.Keys(a);return t.DataBase[n]=await t.dbOpen(n,a,r,{success:async(e,s)=>t.dbCheckTable(o,e)!=o.length?(r=t.dbClose(e),s(await t.dbOpen(n,a,r))):s(e)}),n})))}async dbOpen(e,t,s,r){let n=this,a=n.T,i=a.I;return n.I.Async(((o,l)=>{let c=n.idb.open(e,s);a.on(c,"error",(async e=>{l(e)})),a.on(c,"upgradeneeded",(async e=>{let s=c.result;r&&r.upgradeneeded?await i.Call(r.upgradeneeded,c,s):t&&await n.dbCreateObject(t,s)})),a.on(c,"success",(async e=>{let t=c.result;if(r&&r.success)return await r.success(t,o);o(t)}))}))}async dbCreateObject(e,t){if(!e||!t)return;let s=this,r=s.I;await r.Async(r.toArr(e).map((async e=>{let[n,a]=e;if(!s.dbCheckTable(n,t)){let e=await t.createObjectStore(n);a&&r.toArr(a,(t=>e.createIndex(t[0],t[1]&&t[1].key||t[0],t[1]&&t[1].options||t[1]||{unique:!1})))}})))}dbCheckTable(e,t,s){return t?(this.I.str(e)&&(e=[e]),e=e?e.filter((e=>t.objectStoreNames.contains(e))):[],s?e:e.length):0}async dbU8(e,t){let s=this.I;return s.await(e)&&(e=await e),s.str(e)&&4*e.lenth>t?e=s.encode(e):s.blob(e)&&e.size>t?e=s.U8(await e.arrayBuffer()):e.buffer&&(e=s.U8(e)),e}async dbSelect(e,t){let s=this,r=s.T;s.I.str(e)&&(e={store:e}),e.store instanceof r.StoreBase&&(e.store=e.store.table);let n=e.store,a=await s.dbLoad(e);t=t?"readonly":"readwrite",n||(n=a.objectStoreNames[0]);let i=a.transaction([n],t);return i.onerror=e=>{throw e.preventDefault(),i.error},i.objectStore(n)}async dbGetItem(e){let t=this.I;t.str(e)&&(e={name:e});let s=e.name,r=await this.dbSelect(e,!0);if(s)return t.Async((e=>{r.get(s).onsuccess=t=>e(t.target.result)}))}async dbPutItem(e){let t=this.I,s=await this.dbSelect(e);return t.Async((t=>s.put(e.data,e.name).onsuccess=e=>t(e.target.result)))}async dbRemoveItem(e){let t=this.I,s=e.name,r=await this.dbSelect(e);return t.Async((e=>r.delete(s).onsuccess=t=>e(`delete:${s}`)))}async dbGetAll(e){let t=this,s=t.I,r=t.T,n=await t.dbSelect(e,!0);return s.Async((a=>{let i={};e.index&&(n=n.index(e.index)),n.openCursor(e.Range).onsuccess=n=>{let o=n.target.result;if(o){if(e.only&&r.part&&r.maxsize&&s.u8buf(o.value.contents)&&o.value.filesize>r.maxsize){let e=o.primaryKey.split(r.part),n=e[0],a=e[1]||0;if(i[n])i[n].contents.set(o.value.contents,a*r.maxsize);else{let e=s.U8(o.value.filesize);e.set(o.value.contents,a*r.maxsize),delete o.value.contents,i[n]=t.assign(o.value,{contents:e})}}else i[o.primaryKey]=o.value;o.continue()}else a(i)}}))}async dbGetKeys(e){let t=this,s=t.I;s.str(e)&&(e={dbName:e});let r=await t.dbSelect(e,!0);return s.Async((n=>e.index&&r.indexNames.contains(e.index)?r.index(e.index).getAllKeys(e.Range).onsuccess=r=>{n(e.only?s.toArr(r.target.result).filter((e=>!e.includes(t.T.part))):r.target.result)}:r.getAllKeys().onsuccess=r=>{n(e.only?s.toArr(r.target.result).filter((e=>!e.includes(t.T.part))):r.target.result)}))}async dbGetCursor(e){let t=this,s=t.I;s.str(e)&&(e={index:e});let r=e.index,n=t.T,a=await t.dbSelect(e,!0),i=a.indexNames.length;if(i&&!r)r=a.indexNames[0];else if(!i)return t.dbGetKeys(e);return s.Async((t=>{let i={};a.index(r).openKeyCursor(e.Range).onsuccess=a=>{let o=a.target.result;o?((!e.only||n.part&&!o.primaryKey.includes(n.part))&&(i[o.primaryKey]=s.FromObj([[r,o.key]])),o.continue()):t(i)}}))}async dbRemoveTable(e,t){let s=this,r=s.I;return r.str(e)&&(e=[e]),await r.Async(e.map((async e=>{(await s.dbSelect({store:e,dbName:t})).clear()})))}dbClose(e){let t=this,s=t.I.str(e),r=s?t.DataBase[e]:e;if(r){let n=r.version+1;return r.close(),s&&delete t.DataBase[e],n}}async deleteDatabase(e,t){let s=this;if(t=t||s.dbname,!e)return s.idb.deleteDatabase(t||s.dbname);let r=s.DataBase[t]||await s.dbOpen(t);if(r&&!s.dbCheckTable(e,r))return"ok";let n=s.dbClose(r);return delete s.DataBase[t],await s.dbOpen(t,null,n,{upgradeneeded(t){t.deleteObjectStore(e)},success(e,t){s.close(e),t("ok")}})}get dbname(){return this.T.DB_NAME}constructor(e){let t=this;e.Set(t),e.Set(t.Nttr.prototype),e.Libzip||(e.Libzip=t.zipsrc)}Nttr=class{constructor(e){let t=this,s=t.T,r=s.I;r.str(e)&&(e=s.$(e)),t.obj=e,r.defines(t.obj,{Nttr:t},1,1)}eventList={};get cList(){return this.obj.classList}get active(){return this.contains("active")}set active(e){this.cList[e?"add":"remove"]("active")}get show(){return this.contains("show")}set show(e){this.cList[e?"add":"remove"]("show")}get hidden(){return this.obj.hidden}set hidden(e){return this.obj.hidden=e,this}get css(){return this.obj.style.cssText}set css(e){this.obj.style.cssText=e}get style(){return this.I.toObj(this.obj.style)}set style(e){if(this.I.str(e))return this.css=e;this.I.assign(this.obj.style,e)}html(e){return null!=e?(this.obj.innerHTML=e,this):this.obj.innerHTML}$(e){return this.obj.querySelector(e)}$$(e){return this.obj.querySelectorAll(e)}contains(e){return this.cList.contains(e)}get attrs(){return this.T.I.toObj(this.obj.attributes)}set attrs(e){this.T.I.toArr(e,(e=>this.setAttr(e[0],e[1])))}attr(e,t){let s=this.I.Attr(this.obj,e,t);return t&&this||s}getAttrs(e){return e?this.attr(e):this.attrs}setAttrs(e,t){return t||"string"==typeof e?(this.attr(e,t),this):this.attrs=e}addClass(e){return this.cList.add(e),this}removeClass(e){return this.cList.remove(e),this}addChild(e){return this.obj.appendChild(e),this}appendTo(e){return(e=e||document.body).appendChild(this.obj),this}on(e,t,s){let r=this;return r.eventList[e]||(r.eventList[e]=[]),r.eventList[e].push({func:t,opt:s}),r.T.on(r.obj,e,t,s),r}un(e,t){let s=this;if(s.eventList[e]){let r=[];s.eventList[e].forEach((n=>{let{func:a,opt:i}=n;t&&t!=a?r.push(n):s.removeEvent(e,a,i)})),s.eventList[e]=[],r.length>0&&(s.eventList[e]=r)}else e||s.I.toArr(s.eventList,(e=>{e[1].forEach((t=>{let{func:r,opt:n}=t;s.removeEvent(e[0],r,n)})),delete s.eventList[e[0]]}));return s}once(e,t,s){return this.T.once(this.obj,e,t,s),N}removeEvent(e,t,s){return this.T.un(this.obj,e,t,s)}triger(e,t){let s=this,r=s.T;r.I;s.eventList[e]?s.eventList[e].forEach((e=>e.func.call(s.obj,t))):r.triger(s.obj,e,t)}bind(e,t){let s=this,r=s.T,n=s.I;t||(t=s.I.mobile?"touchend":"click"),n.toArr(e,(e=>r.on(s.$(e[0],this.obj),t,e[1])))}click(e,t,s){let r=this,n=r.I;return t||(t=n.mobile?"touchend":"click"),n.func(e)?(r.un(t),r.on(t,e,s||!1)):r.triger(t,e),r}getBoundingClientRect(){return this.obj.getBoundingClientRect()}remove(){this.un(),this.obj.remove()}get children(){return this.I.toArr(this.obj.children)}get parentNode(){return this.obj.parentNode}get rect(){return this.getBoundingClientRect()}};nWindow=class extends this.Nttr{action={close(){this.hidden=!0},show(){this.hidden=!1},installWindow(){this.addClass("ajaxWindow"),this.html('<div class="container">\n                    <div class="a-header">\n                        <div class="title"><span class="loading">&#61712;</span></div>\n                        <div class="menu">\n                            <button type="button" class="close" data-naction="close">&#61453;</button>\n                        </div>\n                    </div>\n                    <div class="a-body">\n                        <p class="loading">&#61473;</p>\n                    </div>\n                    <div class="a-footer" hidden></div>\n                </div>')},installHeaderEvent(){let e,t=this,s=t.T;e=s.I.mobile?["touchstart","touchmove","touchend"]:["mousedown","mousemove","mouseup","mouseout"],e.forEach((e=>s.on(t.$(".a-header"),e,(e=>{if(("mousedown"==e.type||"touchstart"==e.type)&&e){let{clientX:s,clientY:r}="mousedown"==e.type?e:e.touches[0];t.HeaderPointPos={clientX:s,clientY:r}}if("mouseup"!=e.type&&"mouseout"!=e.type&&"touchend"!=e.type||(t.HeaderPointPos=!1),("mousemove"==e.type||"touchmove"==e.type)&&t.HeaderPointPos){let{clientX:s,clientY:r}="mousemove"==e.type?e:e.touches[0],n=t.$(".container"),a=n.getBoundingClientRect(),i="",o="",l=t.HeaderPointPos.clientX-s,c=t.HeaderPointPos.clientY-r;o=a.top-c,o="top:"+o+"px;bottom:unset;",l=l||0,i=a.left-l,(i<10||i&&a.width+i+15>window.innerWidth)&&(i=parseFloat(n.style.left),i<=10?i=10:i+10>window.innerWidth&&(i-=10)),i="left:"+i+"px;right:unset;width:"+a.width+"px;",t.$(".container").style.cssText=i+o,t.HeaderPointPos={clientX:s,clientY:r}}}))),{passive:!1})},installEvent(){let e=this,t=e.T,s=e.obj;t.on(s,"pointerup",(r=>{let n=r.target;if(n==s)return e.CF("close",n,r);let a=n&&t.attr(n,"data-naction");return a?(t.stopEvent(r),e.CF(a,n,r)):void 0}))},initConfig(e){let t=this,s=t.T;e&&s.I.toArr(e,(e=>{"function"==typeof t[e[0]]&&t[e[0]](e[1])}))}};constructor(e,t){super(e);const s=this;s.$(".container")||s.CF("installWindow"),s.CF("installEvent"),s.CF("installHeaderEvent"),s.CF("initConfig",t)}title(e){this.$(".a-header .title").innerHTML=e}body(e){this.$(".a-body").innerHTML=e}footer(e){this.$(".a-footer").innerHTML=e}hiddenFooter(){this.$(".a-footer").hidden=!0}hiddenPath(e,t){this.$(".a-"+e).hidden=t||!1}}}(this)},{Nttr:Nttr,nWindow:nWindow}=function(){let e=this,t=e.F;return{Nttr(s){if(s instanceof t.Nttr)return s;let r=e.$(s);return r?r.Nttr?r.Nttr:new t.Nttr(r):void 0},nWindow(s,r){let n=e.$(s);return n?s instanceof t.nWindow?s:(s instanceof t.Nttr&&(n=n.obj),new t.nWindow(n,r)):new t.nWindow(e.$ce("div"),r).appendTo()}}}.call(Nenge);